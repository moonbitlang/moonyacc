///|
struct Lexbuf {
  content : String
  mut pos : Int
}

///|
pub fn Lexbuf::from_string(content : String) -> Lexbuf {
  { content, pos: 0 }
}

// NOTE: MoonBit do have unboxed Option[Char] optimization
///|
fn next(self : Lexbuf) -> Char? {
  if self.pos < self.content.length() {
    let ch = self.content[self.pos]
    self.pos += 1
    Some(ch)
  } else {
    None
  }
}

///|
fn substring(self : Lexbuf, start : Int, end : Int) -> String {
  self.content.substring(start~, end~)
}

///|
typealias LexTagAction = Array[Array[Int]]

///|
typealias LexState = Int

///|
typealias LexInput = Int

///|
pub(all) struct LexEngine {
  graph : Array[(LexState) -> (LexState, LexTagAction)]
  end_nodes : Array[(Int, Array[((Int, Int), (Int, Int))])?]
  start_tags : Array[Int]
  code_blocks_n : Int
}

///|
pub fn run(self : LexEngine, lexbuf : Lexbuf) -> (Int, Array[(Int, Int)]) {
  let mut state = 1
  let mut tagState : Array[Array[Int]] = []
  let backtrace = Array::make(self.code_blocks_n, None)
  for tag in self.start_tags {
    while tagState.length() <= tag {
      tagState.push([])
    }
    tagState[tag].push(lexbuf.pos)
  }
  while state != 0 {
    match self.end_nodes[state] {
      Some(t) => backtrace[t.0] = Some((lexbuf.pos, state, tagState))
      _ => ()
    }
    let b = match lexbuf.next() {
      Some(b) => b
      None => '\x00'
    }
    let next = self.graph[state](b.to_int())
    state = next.0
    let new_tagState : Array[Array[Int]] = []
    for i = 0; i < next.1.length(); i = i + 1 {
      new_tagState.push([])
      for j = 0; j < next.1[i].length(); j = j + 1 {
        let t = next.1[i][j]
        if t == -1 {
          new_tagState[i].push(lexbuf.pos)
        } else {
          new_tagState[i].push(tagState[i][t])
        }
      }
    }
    tagState = new_tagState
  }
  for index, b in backtrace {
    match b {
      Some((p, state, tagState)) => {
        lexbuf.pos = p
        let captures = self.end_nodes[state].unwrap().1.map(fn {
          ((b_t, b_r), (e_t, e_r)) => (tagState[b_t][b_r], tagState[e_t][e_r])
        })
        break (index, captures)
      }
      None => ()
    }
  } else {
    (self.code_blocks_n, [])
  }
}

///|
type! LexError {
  UnexpectedEndOfFile
  Unrecognized(String)
}

///|
struct Lexer {
  buf : Lexbuf
  // 0 %%
  // %% 1
  // %% %% 2
  phase : Ref[Int]
}

///|
let token_tag_action_row_0 : Array[Int] = []

///|
let token_tag_action_row_2 : Array[Int] = [-1]

///|
let token_tag_action_row_1 : Array[Int] = [0]

///|
let token_tag_action_row_3 : Array[Int] = [-1, 0]

///|
let token_tag_action_22 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_23 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_31 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_30 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_12 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_14 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_35 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_13 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_36 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_26 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_32 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_16 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
]

///|
let token_tag_action_0 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
]

///|
let token_tag_action_18 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_1 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_11 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_6 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_5 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_15 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_3 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_29 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_25 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_17 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_37 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_10 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_28 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_33 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_8 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_27 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_20 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_21 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_19 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_4 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_1, token_tag_action_row_0,
]

///|
let token_tag_action_34 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_7 : Array[Array[Int]] = [
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_1, token_tag_action_row_2,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_2 : Array[Array[Int]] = [
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_3, token_tag_action_row_2, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_2, token_tag_action_row_0,
  token_tag_action_row_3, token_tag_action_row_2, token_tag_action_row_2, token_tag_action_row_0,
]

///|
let token_tag_action_24 : Array[Array[Int]] = [
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
]

///|
let token_tag_action_9 : Array[Array[Int]] = [
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0, token_tag_action_row_0,
  token_tag_action_row_1, token_tag_action_row_2, token_tag_action_row_0, token_tag_action_row_0,
]

///|
fn token_state_0(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_1(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (16, token_tag_action_0)
    1..=8 => (6, token_tag_action_1)
    9..=10 => (5, token_tag_action_2)
    11..=31 => (6, token_tag_action_1)
    32 => (5, token_tag_action_2)
    33 => (6, token_tag_action_1)
    34 => (7, token_tag_action_3)
    35..=36 => (6, token_tag_action_1)
    37 => (2, token_tag_action_4)
    38..=39 => (6, token_tag_action_1)
    40 => (8, token_tag_action_1)
    41..=44 => (6, token_tag_action_1)
    45 => (9, token_tag_action_5)
    46 => (6, token_tag_action_1)
    47 => (10, token_tag_action_1)
    48..=57 => (6, token_tag_action_1)
    58 => (11, token_tag_action_6)
    59 => (12, token_tag_action_7)
    60 => (13, token_tag_action_8)
    61 => (14, token_tag_action_9)
    62..=64 => (6, token_tag_action_1)
    65..=90 => (15, token_tag_action_9)
    91..=94 => (6, token_tag_action_1)
    95 => (15, token_tag_action_9)
    96 => (6, token_tag_action_1)
    97..=122 => (15, token_tag_action_9)
    123 => (4, token_tag_action_10)
    124 => (3, token_tag_action_11)
    125..=127 => (6, token_tag_action_1)
    _ => panic()
  }
}

///|
fn token_state_2(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    37 => (23, token_tag_action_12)
    100 => (22, token_tag_action_13)
    105 => (21, token_tag_action_14)
    108 => (19, token_tag_action_15)
    110 => (25, token_tag_action_16)
    112 => (18, token_tag_action_17)
    114 => (17, token_tag_action_18)
    115 => (20, token_tag_action_19)
    116 => (24, token_tag_action_20)
    123 => (26, token_tag_action_21)
    _ => (0, [])
  }
}

///|
fn token_state_3(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_4(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_5(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (16, token_tag_action_0)
    1..=8 => (6, token_tag_action_1)
    9..=10 => (5, token_tag_action_2)
    11..=31 => (6, token_tag_action_1)
    32 => (5, token_tag_action_2)
    33 => (6, token_tag_action_1)
    34 => (7, token_tag_action_3)
    35..=36 => (6, token_tag_action_1)
    37 => (2, token_tag_action_4)
    38..=39 => (6, token_tag_action_1)
    40 => (8, token_tag_action_1)
    41..=44 => (6, token_tag_action_1)
    45 => (9, token_tag_action_5)
    46 => (6, token_tag_action_1)
    47 => (10, token_tag_action_1)
    48..=57 => (6, token_tag_action_1)
    58 => (11, token_tag_action_6)
    59 => (12, token_tag_action_7)
    60 => (13, token_tag_action_8)
    61 => (14, token_tag_action_9)
    62..=64 => (6, token_tag_action_1)
    65..=90 => (15, token_tag_action_9)
    91..=94 => (6, token_tag_action_1)
    95 => (15, token_tag_action_9)
    96 => (6, token_tag_action_1)
    97..=122 => (15, token_tag_action_9)
    123 => (4, token_tag_action_10)
    124 => (3, token_tag_action_11)
    125..=127 => (6, token_tag_action_1)
    _ => panic()
  }
}

///|
fn token_state_6(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_7(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=33 => (27, token_tag_action_15)
    35..=127 => (27, token_tag_action_15)
    _ => (0, [])
  }
}

///|
fn token_state_8(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    42 => (28, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_9(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    62 => (29, token_tag_action_23)
    _ => (0, [])
  }
}

///|
fn token_state_10(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    42 => (30, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_11(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_12(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_13(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_14(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_15(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (31, token_tag_action_24)
    65..=90 => (31, token_tag_action_24)
    95 => (31, token_tag_action_24)
    97..=122 => (31, token_tag_action_24)
    _ => (0, [])
  }
}

///|
fn token_state_16(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_17(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    105 => (32, token_tag_action_18)
    _ => (0, [])
  }
}

///|
fn token_state_18(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    111 => (34, token_tag_action_25)
    114 => (33, token_tag_action_26)
    _ => (0, [])
  }
}

///|
fn token_state_19(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (35, token_tag_action_15)
    _ => (0, [])
  }
}

///|
fn token_state_20(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    116 => (36, token_tag_action_19)
    _ => (0, [])
  }
}

///|
fn token_state_21(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    110 => (37, token_tag_action_14)
    _ => (0, [])
  }
}

///|
fn token_state_22(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (38, token_tag_action_13)
    _ => (0, [])
  }
}

///|
fn token_state_23(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_24(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    111 => (40, token_tag_action_27)
    121 => (39, token_tag_action_28)
    _ => (0, [])
  }
}

///|
fn token_state_25(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    111 => (41, token_tag_action_16)
    _ => (0, [])
  }
}

///|
fn token_state_26(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_27(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=33 => (27, token_tag_action_15)
    34 => (42, token_tag_action_29)
    35..=127 => (27, token_tag_action_15)
    _ => (0, [])
  }
}

///|
fn token_state_28(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    41 => (43, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_29(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=8 => (44, token_tag_action_30)
    9..=10 => (45, token_tag_action_23)
    11..=31 => (44, token_tag_action_30)
    32 => (45, token_tag_action_23)
    33..=57 => (44, token_tag_action_30)
    59..=127 => (44, token_tag_action_30)
    _ => (0, [])
  }
}

///|
fn token_state_30(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=41 => (47, token_tag_action_22)
    42 => (46, token_tag_action_22)
    43..=46 => (47, token_tag_action_22)
    47 => (48, token_tag_action_22)
    48..=127 => (47, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_31(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (31, token_tag_action_24)
    65..=90 => (31, token_tag_action_24)
    95 => (31, token_tag_action_24)
    97..=122 => (31, token_tag_action_24)
    _ => (0, [])
  }
}

///|
fn token_state_32(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    103 => (49, token_tag_action_18)
    _ => (0, [])
  }
}

///|
fn token_state_33(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (50, token_tag_action_26)
    _ => (0, [])
  }
}

///|
fn token_state_34(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    115 => (51, token_tag_action_25)
    _ => (0, [])
  }
}

///|
fn token_state_35(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    102 => (52, token_tag_action_15)
    _ => (0, [])
  }
}

///|
fn token_state_36(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    97 => (53, token_tag_action_19)
    _ => (0, [])
  }
}

///|
fn token_state_37(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    108 => (54, token_tag_action_14)
    _ => (0, [])
  }
}

///|
fn token_state_38(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    114 => (55, token_tag_action_13)
    _ => (0, [])
  }
}

///|
fn token_state_39(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    112 => (56, token_tag_action_28)
    _ => (0, [])
  }
}

///|
fn token_state_40(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    107 => (57, token_tag_action_27)
    _ => (0, [])
  }
}

///|
fn token_state_41(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    110 => (58, token_tag_action_16)
    _ => (0, [])
  }
}

///|
fn token_state_42(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_43(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_44(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=57 => (59, token_tag_action_31)
    59..=127 => (59, token_tag_action_31)
    _ => (0, [])
  }
}

///|
fn token_state_45(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=8 => (44, token_tag_action_30)
    9..=10 => (45, token_tag_action_23)
    11..=31 => (44, token_tag_action_30)
    32 => (45, token_tag_action_23)
    33..=57 => (44, token_tag_action_30)
    59..=127 => (44, token_tag_action_30)
    _ => (0, [])
  }
}

///|
fn token_state_46(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=41 => (47, token_tag_action_22)
    42 => (46, token_tag_action_22)
    43..=46 => (47, token_tag_action_22)
    47 => (60, token_tag_action_22)
    48..=127 => (47, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_47(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=41 => (47, token_tag_action_22)
    42 => (46, token_tag_action_22)
    43..=46 => (47, token_tag_action_22)
    47 => (48, token_tag_action_22)
    48..=127 => (47, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_48(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=41 => (61, token_tag_action_22)
    43..=127 => (61, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_49(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    104 => (62, token_tag_action_18)
    _ => (0, [])
  }
}

///|
fn token_state_50(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    99 => (63, token_tag_action_32)
    _ => (0, [])
  }
}

///|
fn token_state_51(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    105 => (64, token_tag_action_25)
    _ => (0, [])
  }
}

///|
fn token_state_52(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    116 => (65, token_tag_action_29)
    _ => (0, [])
  }
}

///|
fn token_state_53(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    114 => (66, token_tag_action_19)
    _ => (0, [])
  }
}

///|
fn token_state_54(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    105 => (67, token_tag_action_14)
    _ => (0, [])
  }
}

///|
fn token_state_55(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    105 => (68, token_tag_action_13)
    _ => (0, [])
  }
}

///|
fn token_state_56(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (69, token_tag_action_33)
    _ => (0, [])
  }
}

///|
fn token_state_57(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (70, token_tag_action_27)
    _ => (0, [])
  }
}

///|
fn token_state_58(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    97 => (71, token_tag_action_16)
    _ => (0, [])
  }
}

///|
fn token_state_59(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=8 => (72, token_tag_action_30)
    9..=10 => (59, token_tag_action_31)
    11..=31 => (72, token_tag_action_30)
    32 => (59, token_tag_action_31)
    33..=57 => (72, token_tag_action_30)
    59..=127 => (72, token_tag_action_30)
    _ => (0, [])
  }
}

///|
fn token_state_60(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=41 => (61, token_tag_action_22)
    43..=127 => (61, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_61(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=41 => (47, token_tag_action_22)
    42 => (46, token_tag_action_22)
    43..=46 => (47, token_tag_action_22)
    47 => (48, token_tag_action_22)
    48..=127 => (47, token_tag_action_22)
    _ => (0, [])
  }
}

///|
fn token_state_62(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    116 => (73, token_tag_action_1)
    _ => (0, [])
  }
}

///|
fn token_state_63(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_64(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    116 => (74, token_tag_action_25)
    _ => (0, [])
  }
}

///|
fn token_state_65(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_66(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    116 => (75, token_tag_action_34)
    _ => (0, [])
  }
}

///|
fn token_state_67(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    110 => (76, token_tag_action_14)
    _ => (0, [])
  }
}

///|
fn token_state_68(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    118 => (77, token_tag_action_13)
    _ => (0, [])
  }
}

///|
fn token_state_69(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_70(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    110 => (78, token_tag_action_21)
    _ => (0, [])
  }
}

///|
fn token_state_71(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    115 => (79, token_tag_action_16)
    _ => (0, [])
  }
}

///|
fn token_state_72(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    1..=8 => (72, token_tag_action_30)
    9..=10 => (59, token_tag_action_31)
    11..=31 => (72, token_tag_action_30)
    32 => (59, token_tag_action_31)
    33..=57 => (72, token_tag_action_30)
    59..=127 => (72, token_tag_action_30)
    _ => (0, [])
  }
}

///|
fn token_state_73(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_74(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    105 => (80, token_tag_action_25)
    _ => (0, [])
  }
}

///|
fn token_state_75(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_76(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (81, token_tag_action_35)
    _ => (0, [])
  }
}

///|
fn token_state_77(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    101 => (82, token_tag_action_36)
    _ => (0, [])
  }
}

///|
fn token_state_78(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_79(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    115 => (83, token_tag_action_16)
    _ => (0, [])
  }
}

///|
fn token_state_80(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    111 => (84, token_tag_action_25)
    _ => (0, [])
  }
}

///|
fn token_state_81(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_82(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_83(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    111 => (85, token_tag_action_16)
    _ => (0, [])
  }
}

///|
fn token_state_84(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    110 => (86, token_tag_action_37)
    _ => (0, [])
  }
}

///|
fn token_state_85(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    99 => (87, token_tag_action_0)
    _ => (0, [])
  }
}

///|
fn token_state_86(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn token_state_87(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
let __mbtlex_engine_token : LexEngine = {
  graph: [
    token_state_0, token_state_1, token_state_2, token_state_3, token_state_4, token_state_5,
    token_state_6, token_state_7, token_state_8, token_state_9, token_state_10, token_state_11,
    token_state_12, token_state_13, token_state_14, token_state_15, token_state_16,
    token_state_17, token_state_18, token_state_19, token_state_20, token_state_21,
    token_state_22, token_state_23, token_state_24, token_state_25, token_state_26,
    token_state_27, token_state_28, token_state_29, token_state_30, token_state_31,
    token_state_32, token_state_33, token_state_34, token_state_35, token_state_36,
    token_state_37, token_state_38, token_state_39, token_state_40, token_state_41,
    token_state_42, token_state_43, token_state_44, token_state_45, token_state_46,
    token_state_47, token_state_48, token_state_49, token_state_50, token_state_51,
    token_state_52, token_state_53, token_state_54, token_state_55, token_state_56,
    token_state_57, token_state_58, token_state_59, token_state_60, token_state_61,
    token_state_62, token_state_63, token_state_64, token_state_65, token_state_66,
    token_state_67, token_state_68, token_state_69, token_state_70, token_state_71,
    token_state_72, token_state_73, token_state_74, token_state_75, token_state_76,
    token_state_77, token_state_78, token_state_79, token_state_80, token_state_81,
    token_state_82, token_state_83, token_state_84, token_state_85, token_state_86,
    token_state_87,
  ],
  end_nodes: [
    None,
    None,
    Some((25, [((44, 0), (45, 0))])),
    Some((18, [((30, 0), (31, 0))])),
    Some((23, [((40, 0), (41, 0))])),
    Some((0, [])),
    Some((25, [((44, 0), (45, 0))])),
    Some((25, [((44, 0), (45, 0))])),
    Some((25, [((44, 0), (45, 0))])),
    Some((25, [((44, 0), (45, 0))])),
    Some((25, [((44, 0), (45, 0))])),
    Some((17, [((28, 0), (29, 0))])),
    Some((20, [((34, 0), (35, 0))])),
    Some((22, [((38, 0), (39, 0))])),
    Some((19, [((32, 0), (33, 0))])),
    Some((4, [((0, 0), (1, 0))])),
    Some((26, [((46, 0), (47, 0))])),
    None,
    None,
    None,
    None,
    None,
    None,
    Some((15, [((22, 0), (23, 0))])),
    None,
    None,
    Some((21, [((36, 0), (37, 0))])),
    None,
    Some((2, [])),
    None,
    None,
    Some((4, [((0, 0), (1, 0))])),
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    Some((24, [((42, 0), (43, 0))])),
    Some((1, [])),
    Some((16, [((24, 0), (25, 0)), ((26, 0), (27, 0))])),
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    None,
    Some((3, [])),
    None,
    None,
    Some((12, [((16, 0), (17, 0))])),
    None,
    Some((9, [((10, 0), (11, 0))])),
    None,
    None,
    None,
    Some((7, [((6, 0), (7, 0))])),
    None,
    None,
    Some((16, [((24, 0), (25, 0)), ((26, 0), (27, 0))])),
    Some((10, [((12, 0), (13, 0))])),
    None,
    Some((5, [((2, 0), (3, 0))])),
    None,
    None,
    Some((6, [((4, 0), (5, 0))])),
    None,
    None,
    Some((14, [((20, 0), (21, 0))])),
    Some((13, [((18, 0), (19, 0))])),
    None,
    None,
    None,
    Some((8, [((8, 0), (9, 0))])),
    Some((11, [((14, 0), (15, 0))])),
  ],
  start_tags: [
    0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 28, 30, 32, 34, 36, 38, 40, 42,
    44, 46,
  ],
  code_blocks_n: 27,
}

///|
fn token(phase : Ref[Int], lexbuf : Lexbuf) -> (Token, Int, Int)!LexError {
  match __mbtlex_engine_token.run(lexbuf) {
    (0, __mbtlex_captures) => token!(phase, lexbuf)
    (1, __mbtlex_captures) => token!(phase, lexbuf)
    (2, __mbtlex_captures) => {
      comment_star_rparen!(lexbuf)
      token!(phase, lexbuf)
    }
    (3, __mbtlex_captures) => token!(phase, lexbuf)
    (4, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (IDENT(t), _start_pos_of_t, _end_pos_of_t)
    }
    (5, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_START, _start_pos_of_t, _end_pos_of_t)
    }
    (6, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_TOKEN, _start_pos_of_t, _end_pos_of_t)
    }
    (7, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_TYPE, _start_pos_of_t, _end_pos_of_t)
    }
    (8, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_POSITION, _start_pos_of_t, _end_pos_of_t)
    }
    (9, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_LEFT, _start_pos_of_t, _end_pos_of_t)
    }
    (10, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_RIGHT, _start_pos_of_t, _end_pos_of_t)
    }
    (11, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_NONASSOC, _start_pos_of_t, _end_pos_of_t)
    }
    (12, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_PREC, _start_pos_of_t, _end_pos_of_t)
    }
    (13, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_DERIVE, _start_pos_of_t, _end_pos_of_t)
    }
    (14, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (PERCENT_INLINE, _start_pos_of_t, _end_pos_of_t)
    }
    (15, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      if phase.val <= 0 {
        phase.val += 1
        (PERCENT_PERCENT, _start_pos_of_t, _end_pos_of_t)
      } else {
        phase.val += 1
        let sb = StringBuilder::new()
        code_eof(sb, lexbuf)
        (
          PERCENT_PERCENT_CODE_EOF(sb.to_string()),
          _start_pos_of_t,
          _end_pos_of_t,
        )
      }
    }
    (16, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let (_start_pos_of_t2, _end_pos_of_t2) = __mbtlex_captures[1]
      let t2 : String = lexbuf.substring(_start_pos_of_t2, _end_pos_of_t2)
      (ARROW_CODE(t2), _start_pos_of_t, _end_pos_of_t)
    }
    (17, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (COLON, _start_pos_of_t, _end_pos_of_t)
    }
    (18, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (BAR, _start_pos_of_t, _end_pos_of_t)
    }
    (19, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (EQ, _start_pos_of_t, _end_pos_of_t)
    }
    (20, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (SEMI, _start_pos_of_t, _end_pos_of_t)
    }
    (21, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let sb = StringBuilder::new()
      code_percent_rbrace!(sb, lexbuf)
      (
        PERCENT_LBRACE_CODE_PERCENT_RBRACE(sb.to_string()),
        _start_pos_of_t,
        _end_pos_of_t,
      )
    }
    (22, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let sb = StringBuilder::new()
      code_rangle!(sb, lexbuf)
      (LANGLE_CODE_RANGLE(sb.to_string()), _start_pos_of_t, _end_pos_of_t)
    }
    (23, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let sb = StringBuilder::new()
      let subst = []
      let base = lexbuf.pos
      code_rbrace!(sb, subst, base, lexbuf)
      (
        LBRACE_CODE_RBRACE((sb.to_string(), base, subst)),
        _start_pos_of_t,
        lexbuf.pos,
      )
    }
    (24, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (STRING(t), _start_pos_of_t, _end_pos_of_t)
    }
    (25, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      raise Unrecognized(t)
    }
    (26, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      (EOF, _start_pos_of_t, _end_pos_of_t)
    }
    _ => abort("lex: fail to match")
  }
}

///|
let comment_star_rparen_tag_action_0 : Array[Array[Int]] = []

///|
fn comment_star_rparen_state_0(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn comment_star_rparen_state_1(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (5, comment_star_rparen_tag_action_0)
    1..=39 => (4, comment_star_rparen_tag_action_0)
    40 => (2, comment_star_rparen_tag_action_0)
    41 => (4, comment_star_rparen_tag_action_0)
    42 => (3, comment_star_rparen_tag_action_0)
    43..=127 => (4, comment_star_rparen_tag_action_0)
    _ => panic()
  }
}

///|
fn comment_star_rparen_state_2(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    42 => (6, comment_star_rparen_tag_action_0)
    _ => (0, [])
  }
}

///|
fn comment_star_rparen_state_3(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    41 => (7, comment_star_rparen_tag_action_0)
    _ => (0, [])
  }
}

///|
fn comment_star_rparen_state_4(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn comment_star_rparen_state_5(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn comment_star_rparen_state_6(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn comment_star_rparen_state_7(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
let __mbtlex_engine_comment_star_rparen : LexEngine = {
  graph: [
    comment_star_rparen_state_0, comment_star_rparen_state_1, comment_star_rparen_state_2,
    comment_star_rparen_state_3, comment_star_rparen_state_4, comment_star_rparen_state_5,
    comment_star_rparen_state_6, comment_star_rparen_state_7,
  ],
  end_nodes: [
    None,
    None,
    Some((2, [])),
    Some((2, [])),
    Some((2, [])),
    Some((3, [])),
    Some((0, [])),
    Some((1, [])),
  ],
  start_tags: [],
  code_blocks_n: 4,
}

///|
fn comment_star_rparen(lexbuf : Lexbuf) -> Unit!LexError {
  match __mbtlex_engine_comment_star_rparen.run(lexbuf) {
    (0, __mbtlex_captures) => {
      comment_star_rparen!(lexbuf)
      comment_star_rparen!(lexbuf)
    }
    (1, __mbtlex_captures) => ()
    (2, __mbtlex_captures) => comment_star_rparen!(lexbuf)
    (3, __mbtlex_captures) => raise UnexpectedEndOfFile
    _ => abort("lex: fail to match")
  }
}

///|
let code_eof_tag_action_row_0 : Array[Int] = []

///|
let code_eof_tag_action_row_2 : Array[Int] = [-1]

///|
let code_eof_tag_action_row_1 : Array[Int] = [0]

///|
let code_eof_tag_action_0 : Array[Array[Int]] = [
  code_eof_tag_action_row_0, code_eof_tag_action_row_0,
]

///|
let code_eof_tag_action_1 : Array[Array[Int]] = [
  code_eof_tag_action_row_1, code_eof_tag_action_row_2,
]

///|
fn code_eof_state_0(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_eof_state_1(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (3, code_eof_tag_action_0)
    1..=127 => (2, code_eof_tag_action_1)
    _ => panic()
  }
}

///|
fn code_eof_state_2(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_eof_state_3(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
let __mbtlex_engine_code_eof : LexEngine = {
  graph: [
    code_eof_state_0, code_eof_state_1, code_eof_state_2, code_eof_state_3,
  ],
  end_nodes: [None, None, Some((0, [((0, 0), (1, 0))])), Some((1, []))],
  start_tags: [0],
  code_blocks_n: 2,
}

///|
fn code_eof(sb : StringBuilder, lexbuf : Lexbuf) -> Unit {
  match __mbtlex_engine_code_eof.run(lexbuf) {
    (0, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      sb.write_string(t)
      code_eof(sb, lexbuf)
    }
    (1, __mbtlex_captures) => ()
    _ => abort("lex: fail to match")
  }
}

///|
let code_percent_rbrace_tag_action_row_0 : Array[Int] = []

///|
let code_percent_rbrace_tag_action_row_2 : Array[Int] = [-1]

///|
let code_percent_rbrace_tag_action_row_1 : Array[Int] = [0]

///|
let code_percent_rbrace_tag_action_0 : Array[Array[Int]] = [
  code_percent_rbrace_tag_action_row_0, code_percent_rbrace_tag_action_row_0,
]

///|
let code_percent_rbrace_tag_action_1 : Array[Array[Int]] = [
  code_percent_rbrace_tag_action_row_1, code_percent_rbrace_tag_action_row_2,
]

///|
fn code_percent_rbrace_state_0(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_percent_rbrace_state_1(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (4, code_percent_rbrace_tag_action_0)
    1..=36 => (2, code_percent_rbrace_tag_action_1)
    37 => (3, code_percent_rbrace_tag_action_1)
    38..=127 => (2, code_percent_rbrace_tag_action_1)
    _ => panic()
  }
}

///|
fn code_percent_rbrace_state_2(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_percent_rbrace_state_3(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    125 => (5, code_percent_rbrace_tag_action_0)
    _ => (0, [])
  }
}

///|
fn code_percent_rbrace_state_4(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_percent_rbrace_state_5(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
let __mbtlex_engine_code_percent_rbrace : LexEngine = {
  graph: [
    code_percent_rbrace_state_0, code_percent_rbrace_state_1, code_percent_rbrace_state_2,
    code_percent_rbrace_state_3, code_percent_rbrace_state_4, code_percent_rbrace_state_5,
  ],
  end_nodes: [
    None,
    None,
    Some((1, [((0, 0), (1, 0))])),
    Some((1, [((0, 0), (1, 0))])),
    Some((2, [])),
    Some((0, [])),
  ],
  start_tags: [0],
  code_blocks_n: 3,
}

///|
fn code_percent_rbrace(sb : StringBuilder, lexbuf : Lexbuf) -> Unit!LexError {
  match __mbtlex_engine_code_percent_rbrace.run(lexbuf) {
    (0, __mbtlex_captures) => ()
    (1, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      sb.write_string(t)
      code_percent_rbrace!(sb, lexbuf)
    }
    (2, __mbtlex_captures) => raise UnexpectedEndOfFile
    _ => abort("lex: fail to match")
  }
}

///|
let code_rangle_tag_action_row_0 : Array[Int] = []

///|
let code_rangle_tag_action_row_2 : Array[Int] = [-1]

///|
let code_rangle_tag_action_row_1 : Array[Int] = [0]

///|
let code_rangle_tag_action_0 : Array[Array[Int]] = [
  code_rangle_tag_action_row_0, code_rangle_tag_action_row_0,
]

///|
let code_rangle_tag_action_1 : Array[Array[Int]] = [
  code_rangle_tag_action_row_1, code_rangle_tag_action_row_2,
]

///|
fn code_rangle_state_0(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rangle_state_1(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (4, code_rangle_tag_action_0)
    1..=61 => (2, code_rangle_tag_action_1)
    62 => (3, code_rangle_tag_action_1)
    63..=127 => (2, code_rangle_tag_action_1)
    _ => panic()
  }
}

///|
fn code_rangle_state_2(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rangle_state_3(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rangle_state_4(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
let __mbtlex_engine_code_rangle : LexEngine = {
  graph: [
    code_rangle_state_0, code_rangle_state_1, code_rangle_state_2, code_rangle_state_3,
    code_rangle_state_4,
  ],
  end_nodes: [
    None,
    None,
    Some((1, [((0, 0), (1, 0))])),
    Some((0, [])),
    Some((2, [])),
  ],
  start_tags: [0],
  code_blocks_n: 3,
}

///|
fn code_rangle(sb : StringBuilder, lexbuf : Lexbuf) -> Unit!LexError {
  match __mbtlex_engine_code_rangle.run(lexbuf) {
    (0, __mbtlex_captures) => ()
    (1, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      sb.write_string(t)
      code_rangle!(sb, lexbuf)
    }
    (2, __mbtlex_captures) => raise UnexpectedEndOfFile
    _ => abort("lex: fail to match")
  }
}

///|
let code_rbrace_tag_action_row_0 : Array[Int] = []

///|
let code_rbrace_tag_action_row_2 : Array[Int] = [-1]

///|
let code_rbrace_tag_action_row_1 : Array[Int] = [0]

///|
let code_rbrace_tag_action_0 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_1 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2,
]

///|
let code_rbrace_tag_action_4 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_6 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_9 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_5 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_7 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_8 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_10 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_11 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_12 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_13 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
let code_rbrace_tag_action_2 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_2,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2,
]

///|
let code_rbrace_tag_action_3 : Array[Array[Int]] = [
  code_rbrace_tag_action_row_1, code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_1,
  code_rbrace_tag_action_row_2, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
  code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0, code_rbrace_tag_action_row_0,
]

///|
fn code_rbrace_state_0(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_1(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    0 => (5, code_rbrace_tag_action_0)
    1..=35 => (6, code_rbrace_tag_action_1)
    36 => (2, code_rbrace_tag_action_2)
    37..=122 => (6, code_rbrace_tag_action_1)
    123 => (3, code_rbrace_tag_action_1)
    124 => (6, code_rbrace_tag_action_1)
    125 => (4, code_rbrace_tag_action_1)
    126..=127 => (6, code_rbrace_tag_action_1)
    _ => panic()
  }
}

///|
fn code_rbrace_state_2(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (11, code_rbrace_tag_action_3)
    65..=90 => (7, code_rbrace_tag_action_4)
    95 => (7, code_rbrace_tag_action_4)
    97..=100 => (7, code_rbrace_tag_action_4)
    101 => (8, code_rbrace_tag_action_5)
    102..=107 => (7, code_rbrace_tag_action_4)
    108 => (9, code_rbrace_tag_action_5)
    109..=114 => (7, code_rbrace_tag_action_4)
    115 => (10, code_rbrace_tag_action_5)
    116..=122 => (7, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_3(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_4(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_5(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_6(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_7(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_8(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=109 => (12, code_rbrace_tag_action_4)
    110 => (13, code_rbrace_tag_action_5)
    111..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_9(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=110 => (12, code_rbrace_tag_action_4)
    111 => (14, code_rbrace_tag_action_5)
    112..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_10(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=107 => (12, code_rbrace_tag_action_4)
    108 => (16, code_rbrace_tag_action_6)
    109..=115 => (12, code_rbrace_tag_action_4)
    116 => (15, code_rbrace_tag_action_5)
    117..=120 => (12, code_rbrace_tag_action_4)
    121 => (17, code_rbrace_tag_action_6)
    122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_11(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (11, code_rbrace_tag_action_3)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_12(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_13(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=99 => (12, code_rbrace_tag_action_4)
    100 => (18, code_rbrace_tag_action_5)
    101..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_14(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=98 => (12, code_rbrace_tag_action_4)
    99 => (19, code_rbrace_tag_action_7)
    100..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_15(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97 => (20, code_rbrace_tag_action_5)
    98..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_16(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=110 => (12, code_rbrace_tag_action_4)
    111 => (21, code_rbrace_tag_action_6)
    112..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_17(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=108 => (12, code_rbrace_tag_action_4)
    109 => (22, code_rbrace_tag_action_6)
    110..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_18(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=111 => (12, code_rbrace_tag_action_4)
    112 => (23, code_rbrace_tag_action_5)
    113..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_19(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    40 => (24, code_rbrace_tag_action_8)
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_20(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=113 => (12, code_rbrace_tag_action_4)
    114 => (25, code_rbrace_tag_action_5)
    115..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_21(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=98 => (12, code_rbrace_tag_action_4)
    99 => (26, code_rbrace_tag_action_9)
    100..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_22(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97 => (12, code_rbrace_tag_action_4)
    98 => (27, code_rbrace_tag_action_6)
    99..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_23(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=110 => (12, code_rbrace_tag_action_4)
    111 => (28, code_rbrace_tag_action_5)
    112..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_24(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    9 => (29, code_rbrace_tag_action_8)
    32 => (29, code_rbrace_tag_action_8)
    36 => (30, code_rbrace_tag_action_10)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_25(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=115 => (12, code_rbrace_tag_action_4)
    116 => (31, code_rbrace_tag_action_5)
    117..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_26(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_27(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=110 => (12, code_rbrace_tag_action_4)
    111 => (32, code_rbrace_tag_action_6)
    112..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_28(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=114 => (12, code_rbrace_tag_action_4)
    115 => (33, code_rbrace_tag_action_7)
    116..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_29(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    9 => (29, code_rbrace_tag_action_8)
    32 => (29, code_rbrace_tag_action_8)
    36 => (30, code_rbrace_tag_action_10)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_30(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (34, code_rbrace_tag_action_11)
    65..=90 => (35, code_rbrace_tag_action_11)
    95 => (35, code_rbrace_tag_action_11)
    97..=122 => (35, code_rbrace_tag_action_11)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_31(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=111 => (12, code_rbrace_tag_action_4)
    112 => (36, code_rbrace_tag_action_5)
    113..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_32(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=107 => (12, code_rbrace_tag_action_4)
    108 => (37, code_rbrace_tag_action_6)
    109..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_33(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    40 => (24, code_rbrace_tag_action_8)
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_34(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    9 => (39, code_rbrace_tag_action_12)
    32 => (39, code_rbrace_tag_action_12)
    41 => (38, code_rbrace_tag_action_13)
    48..=57 => (34, code_rbrace_tag_action_11)
    65..=90 => (35, code_rbrace_tag_action_11)
    95 => (35, code_rbrace_tag_action_11)
    97..=122 => (35, code_rbrace_tag_action_11)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_35(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    9 => (39, code_rbrace_tag_action_12)
    32 => (39, code_rbrace_tag_action_12)
    41 => (38, code_rbrace_tag_action_13)
    48..=57 => (40, code_rbrace_tag_action_11)
    65..=90 => (40, code_rbrace_tag_action_11)
    95 => (40, code_rbrace_tag_action_11)
    97..=122 => (40, code_rbrace_tag_action_11)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_36(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=110 => (12, code_rbrace_tag_action_4)
    111 => (41, code_rbrace_tag_action_5)
    112..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_37(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=114 => (12, code_rbrace_tag_action_4)
    115 => (42, code_rbrace_tag_action_6)
    116..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_38(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_39(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    9 => (39, code_rbrace_tag_action_12)
    32 => (39, code_rbrace_tag_action_12)
    41 => (38, code_rbrace_tag_action_13)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_40(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    9 => (39, code_rbrace_tag_action_12)
    32 => (39, code_rbrace_tag_action_12)
    41 => (38, code_rbrace_tag_action_13)
    48..=57 => (40, code_rbrace_tag_action_11)
    65..=90 => (40, code_rbrace_tag_action_11)
    95 => (40, code_rbrace_tag_action_11)
    97..=122 => (40, code_rbrace_tag_action_11)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_41(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=114 => (12, code_rbrace_tag_action_4)
    115 => (43, code_rbrace_tag_action_7)
    116..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_42(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=115 => (12, code_rbrace_tag_action_4)
    116 => (44, code_rbrace_tag_action_6)
    117..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_43(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    40 => (24, code_rbrace_tag_action_8)
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_44(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97 => (45, code_rbrace_tag_action_6)
    98..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_45(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=113 => (12, code_rbrace_tag_action_4)
    114 => (46, code_rbrace_tag_action_6)
    115..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_46(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=115 => (12, code_rbrace_tag_action_4)
    116 => (47, code_rbrace_tag_action_6)
    117..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_47(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=111 => (12, code_rbrace_tag_action_4)
    112 => (48, code_rbrace_tag_action_6)
    113..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_48(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=110 => (12, code_rbrace_tag_action_4)
    111 => (49, code_rbrace_tag_action_6)
    112..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_49(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=114 => (12, code_rbrace_tag_action_4)
    115 => (50, code_rbrace_tag_action_9)
    116..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
fn code_rbrace_state_50(input : LexInput) -> (LexState, LexTagAction) {
  match input {
    48..=57 => (12, code_rbrace_tag_action_4)
    65..=90 => (12, code_rbrace_tag_action_4)
    95 => (12, code_rbrace_tag_action_4)
    97..=122 => (12, code_rbrace_tag_action_4)
    _ => (0, [])
  }
}

///|
let __mbtlex_engine_code_rbrace : LexEngine = {
  graph: [
    code_rbrace_state_0, code_rbrace_state_1, code_rbrace_state_2, code_rbrace_state_3,
    code_rbrace_state_4, code_rbrace_state_5, code_rbrace_state_6, code_rbrace_state_7,
    code_rbrace_state_8, code_rbrace_state_9, code_rbrace_state_10, code_rbrace_state_11,
    code_rbrace_state_12, code_rbrace_state_13, code_rbrace_state_14, code_rbrace_state_15,
    code_rbrace_state_16, code_rbrace_state_17, code_rbrace_state_18, code_rbrace_state_19,
    code_rbrace_state_20, code_rbrace_state_21, code_rbrace_state_22, code_rbrace_state_23,
    code_rbrace_state_24, code_rbrace_state_25, code_rbrace_state_26, code_rbrace_state_27,
    code_rbrace_state_28, code_rbrace_state_29, code_rbrace_state_30, code_rbrace_state_31,
    code_rbrace_state_32, code_rbrace_state_33, code_rbrace_state_34, code_rbrace_state_35,
    code_rbrace_state_36, code_rbrace_state_37, code_rbrace_state_38, code_rbrace_state_39,
    code_rbrace_state_40, code_rbrace_state_41, code_rbrace_state_42, code_rbrace_state_43,
    code_rbrace_state_44, code_rbrace_state_45, code_rbrace_state_46, code_rbrace_state_47,
    code_rbrace_state_48, code_rbrace_state_49, code_rbrace_state_50,
  ],
  end_nodes: [
    None,
    None,
    Some((6, [((16, 0), (17, 0))])),
    Some((0, [])),
    Some((1, [])),
    Some((7, [])),
    Some((6, [((16, 0), (17, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((2, [((0, 0), (1, 0)), ((2, 0), (3, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((4, [((10, 0), (11, 0)), ((12, 0), (13, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    None,
    Some((5, [((14, 0), (15, 0))])),
    Some((4, [((10, 0), (11, 0)), ((12, 0), (13, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    None,
    None,
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((4, [((10, 0), (11, 0)), ((12, 0), (13, 0))])),
    None,
    None,
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((3, [((4, 0), (5, 0)), ((6, 0), (7, 0)), ((8, 0), (9, 0))])),
    None,
    None,
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((4, [((10, 0), (11, 0)), ((12, 0), (13, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((5, [((14, 0), (15, 0))])),
    Some((4, [((10, 0), (11, 0)), ((12, 0), (13, 0))])),
  ],
  start_tags: [0, 4, 10, 14, 16],
  code_blocks_n: 8,
}

///|
fn code_rbrace(
  sb : StringBuilder,
  subst : Array[SubstItem],
  base : Int,
  lexbuf : Lexbuf
) -> Unit!LexError {
  match __mbtlex_engine_code_rbrace.run(lexbuf) {
    (0, __mbtlex_captures) => {
      sb.write_string("{")
      code_rbrace!(sb, subst, base, lexbuf)
      sb.write_string("}")
      code_rbrace!(sb, subst, base, lexbuf)
    }
    (1, __mbtlex_captures) => ()
    (2, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let (_start_pos_of_t1, _end_pos_of_t1) = __mbtlex_captures[1]
      let t1 : String = lexbuf.substring(_start_pos_of_t1, _end_pos_of_t1)
      sb.write_string(t)
      let index = try {
        @strconv.parse_int!(t1, base=10)
      } catch {
        err => abort(Show::to_string(err))
      }
      subst.push({
        start: _start_pos_of_t - base,
        end: _end_pos_of_t - base,
        desc: Dollar(index),
      })
      code_rbrace!(sb, subst, base, lexbuf)
    }
    (3, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let (_start_pos_of_t1, _end_pos_of_t1) = __mbtlex_captures[1]
      let t1 : String = lexbuf.substring(_start_pos_of_t1, _end_pos_of_t1)
      let (_start_pos_of_t2, _end_pos_of_t2) = __mbtlex_captures[2]
      let t2 : String = lexbuf.substring(_start_pos_of_t2, _end_pos_of_t2)
      sb.write_string(t)
      let arg : ClauseItemIdent = if t2.starts_with("$") {
        let index = try {
          @strconv.parse_int!(t2.substring(start=1), base=10)
        } catch {
          err => abort(Show::to_string(err))
        }
        Dollar(index)
      } else {
        Name(t2)
      }
      subst.push({
        start: _start_pos_of_t - base,
        end: _end_pos_of_t - base,
        desc: match t1 {
          "startpos" => StartPosOf(arg)
          "endpos" => EndPosOf(arg)
          "loc" => LocOf(arg)
          _ => panic()
        },
      })
      code_rbrace!(sb, subst, base, lexbuf)
    }
    (4, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      ignore(t)
      let (_start_pos_of_t1, _end_pos_of_t1) = __mbtlex_captures[1]
      let t1 : String = lexbuf.substring(_start_pos_of_t1, _end_pos_of_t1)
      sb.write_string(t)
      subst.push({
        start: _start_pos_of_t - base,
        end: _end_pos_of_t - base,
        desc: match t1 {
          "startpos" => StartPos
          "endpos" => EndPos
          "loc" => Loc
          "symbolstartpos" => SymbolStartPos
          "sloc" => Sloc
          _ => panic()
        },
      })
      code_rbrace!(sb, subst, base, lexbuf)
    }
    (5, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      sb.write_string(t)
      code_rbrace!(sb, subst, base, lexbuf)
    }
    (6, __mbtlex_captures) => {
      let (_start_pos_of_t, _end_pos_of_t) = __mbtlex_captures[0]
      let t : String = lexbuf.substring(_start_pos_of_t, _end_pos_of_t)
      sb.write_string(t)
      code_rbrace!(sb, subst, base, lexbuf)
    }
    (7, __mbtlex_captures) => raise UnexpectedEndOfFile
    _ => abort("lex: fail to match")
  }
}

///|
pub fn new_lexer(input : String) -> Lexer {
  { buf: Lexbuf::from_string(input), phase: { val: 0 } }
}

///|
pub fn next_token(self : Lexer) -> (Token, Int, Int)! {
  token!(self.phase, self.buf)
}
